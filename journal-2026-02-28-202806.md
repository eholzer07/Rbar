# Session Journal — 2026-02-28 20:28

## Session Goal
Implement Chunk 4: Venue Data Seeding (Pilot: Chicago + NYC)

---

## Milestones

### Chunk 4 — Venue Data Seeding complete (2026-03-01)

**Research (Steps 1–2):** Used WebSearch agents to find 18 verified Chicago sports bars and
18 verified NYC sports bars. Checked for closures (Casey Moran's and Old Town Pour House removed).
Compiled into `data/venues/chicago.json` and `data/venues/nyc.json`.

**Geocoding helper (Step 3):** Created `src/lib/geocoding.ts` using Nominatim (OpenStreetMap).
No API key. Query format: `{address}, {city}, {state}, USA`. Returns `{lat, lng} | null`.

**Seed script (Steps 4–5):** Created `scripts/seed-venues.ts`:
- Loads all JSON files from `data/venues/`
- Geocodes each address (1100ms delay per request)
- Upserts venues by `(name, city)` — idempotent
- Upserts VenueTeam links by `(venueId, teamId)`
- After all venues: runs raw SQL to populate PostGIS `location` column
- Added `seed:venues` npm script to `package.json`

**Address fix:** Queens-style hyphenated addresses (`32-04 Broadway`) fail Nominatim. Fixed by
using bare street name (`Broadway`) for Break Bar & Billiards in Astoria, NY.

**Validation results:**
- `tsc --noEmit` — 0 errors
- `npm run lint` — 0 errors
- 36 venues in DB, all with lat/lng and PostGIS location
- 119 VenueTeam links
- Idempotency confirmed: 4th run produces 0 created, 36 updated, 0 skipped, 0 new links

**Docs:** Created `docs/chunks/chunk-04-venue-seeding.md`, updated `memory/next-session.md`.

**Committed and pushed:** `f9323cf` on `main` — "Chunk 4: Venue data seeding — Chicago + NYC pilot (36 venues)"

**PROJECT_PLAN.md updated:** Chunk 4 marked complete with actual approach documented. Completion log added at bottom of plan.
